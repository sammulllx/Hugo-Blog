---
title: "Linux基础"
date: 2023-05-17T09:46:46+08:00
# weight: 1
# aliases: ["/first"]
tags: ["first"]
author: "Me"
# author: ["Me", "You"] # multiple authors
showToc: true
TocOpen: false
draft: false
hidemeta: false
comments: false
description: "Desc Text."
canonicalURL: "https://canonical.url/to/page"
disableHLJS: true # to disable highlightjs
disableShare: false
disableHLJS: false
hideSummary: false
searchHidden: true
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
ShowWordCount: true
ShowRssButtonInSectionTermList: true
UseHugoToc: true
cover:
    image: "<image path/url>" # image path/url
    alt: "<alt text>" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: true # only hide on current single page
editPost:
    URL: "https://github.com/<path_to_repo>/content"
    Text: "Suggest Changes" # edit text
    appendFilePath: true # to append file path to Edit link
---

# ubuntu

### 查找文件内容

| 命令                 | 对应英文    | 作用                                              |
| -------------------- | ----------- | ------------------------------------------------- |
| cat 文件名           | concatenate | 查看文件内容,创建文件,文件合并,追加文件内容等功能 |
| more 文件名          | more        | 分屏显示文件内容                                  |
| grep 搜索文本 文件名 | grep        | 搜索文本文件内容                                  |

cat选项:

| 选项 | 含义                   |
| ---- | ---------------------- |
| -b   | 对非空输出行编号       |
| -n   | 对输出的所有行进行编号 |

> linux中还有一个`nl`命令和`cat -b`等效

more操作:

| 操作间  | 功能                 |
| ------- | -------------------- |
| 空格键  | 显示手册页的下一屏   |
| Enter键 | 一次滚动手册页的一行 |
| b       | 回滚一屏             |
| f       | 前滚一屏             |
| q       | 退出                 |
| /word   | 搜索word字符串       |

grep选项:

| 选项 | 含义                                   |
| ---- | -------------------------------------- |
| -n   | 显示匹配行及行号                       |
| -v   | 显示不包含匹配文本的所有行(相当于求反) |
| -i   | 忽略大小写                             |

grep常用:

| 参数 | 含义                  |
| ---- | --------------------- |
| ^a   | 行首,搜寻以a开头的行  |
| ke$  | 行尾,搜寻以ke结束的行 |

### 重定向

| 命令                    | 作用                                          |
| ----------------------- | --------------------------------------------- |
| echo 文字内容           | 在终端显示文字内容,通常会和重定向联合使用     |
| echo 文字内容 > 文件名  | 将文字内容输出到文件中,覆盖原内容             |
| echo 文字内容 >> 文件名 | 将文字内容输出到文件中,添加到行尾             |
| 命令如ls > 文件名       | 将当前目录下所有文件名输出到文件中,覆盖原内容 |
| 命令如ls >> 文件名      | 将当前目录下所有文件名输出到文件中,添加到行位 |

> linux允许命令执行结果重定向到一个文件
> 
> 将本应显示在终端上的内容输出/追加到指定文件中

### 管道

- linux允许将一个命令的输出可以通过管道做为另一个命令的输人

- 可以理解为显示生活中的管子,管子的一头塞东西进去,另一头出来,这里`|`
  
  的左右分为两端,左端可以塞东西(写),右端取东西(读)

常用的管道命令有:

- more:分屏显示内容
- grep:在命令执行结果的基础上查找指定文本

### 复制文件cp

| 参数 | 作用                                                                                       |
| ---- | ------------------------------------------------------------------------------------------ |
| -i   | 覆盖文件前提示                                                                             |
| -r   | 若给出的源文件是目录文件,则cp将递归复制该目录下的所有子目录和文件,目标文件必须为一个目录名 |

### ssh免密登录

ssh-keygen #生成ssh钥匙

ssh-copy-id user@ip #可以让远程服务器记住我们的公钥

非对称加密：

- 使用公钥加密的数据，需要使用私钥解密。
- 使用私钥加密的数据，需要使用公钥解密。

### 配置远程计算机别名

```
Host              myubuntu            #自定义别名
     HostName        192.168.1.13         #替换为你的ssh服务器ip或domain
     User            sammul            #ssh服务器用户名
     Port            22             #ssh服务器端口，默认为22 
     IdentityFile    ~/.ssh/id_rsa    #私钥文件，默认为id_rsa
```

### ls -l查看权限

拥有者前面的那个数字是硬链接数，就是有多少种方式可以访问到当前目录、文件。

- 文件一般是1
- 没有子文件夹的文件夹是2（一个绝对路径一个.)
- 有子文件夹的文件夹是2+子文件夹数

### 组管理

| 命令                      | 作用                      |
| ------------------------- | ------------------------- |
| groupadd xxx              | 添加组                    |
| groupdel xxx              | 删除组                    |
| cat /etc/group            | 确认组信息                |
| chgrp -R 组名 文件/目录名 | 递归修改文件/目录所属的组 |

其中创建组/删除组的操作都需要通过`sudo`执行

### 用户管理

| 命令                            | 作用         | 说明                                                         |
| ------------------------------- | ------------ | ------------------------------------------------------------ |
| useradd -m -g 组名 新建用户名   | 添加新用户   | -m 自动建立用户家目录 -g 指定用户所在组,否则会建立一个同名组 |
| passwd 用户名                   | 设置用户密码 | 如果是普通用户,直接用passwd可以修改自己的账户密码            |
| userdel -r 用户名               | 删除用户     | -r 选项会自动删除用户家目录                                  |
| cat /etc/passwd \|  grep 用户名 | 确认用户信息 | 新建用户后,用户信息会保存在/etc/passwd文件中                 |

> 提示:
> 
> 1. 创建用户时,如果忘记添加`-m`选项指定新用户的家目录,最简单的方法就是删除用户然后重新创建
> 2. 创建用户时,默认会创建一个和用户名同名的组名
> 3. 用户信息保存在/etc/passwd文件中

### 查看用户信息

| 命令        | 作用                       |
| ----------- | -------------------------- |
| id [用户名] | 查看用户UID和GID信息       |
| who         | 查看当前所有登录的用户列表 |
| whoami      | 查看当前登录用户的账户名   |

> /etc/passwd文件存放的事用户的信息,由6个分号组成的7个信息,分别是
> 
> 1. 用户名
> 2. 密码(x代表加密的密码)
> 3. UID(用户标识)
> 4. GID(用户组标识)
> 5. 用户全名或者本地账号
> 6. 家目录
> 7. 登录用的shell,就是登录以后使用的终端命令,ubuntu默认是dash

### 更改用户组信息

| 命令                        | 作用                          |
| :-------------------------- | ----------------------------- |
| usermod -g 组 用户名        | 修改用户的主组(passwd中的GID) |
| usermod -G 组 用户名        | 修改用户的附加组              |
| usermod -s /bin/bash 用户名 | 修改用户登录Shell             |

> 1. 主组:通常在新建用户时指定,在/etc/passwd的第四列GID对应的组
> 2. 副组:在/etc/group中最后一列表示该组的用户列表,用于指定用户的附加权限

### which命令

| 命令          | 输出               |
| ------------- | ------------------ |
| which ls      | /user/bin/ls       |
| which useradd | /user/sbin/useradd |

> 1. 在linux中,绝大多数可执行文件都保存在/bin,/sbin,/usr/bin,/usr/sbin
> 2. /bin(binary)是二进制执行文件目录,主要用于具体应用
> 3. /sbin(system binary)是系统管理员专用的二进制代码存放目录,主要用于系统管理
> 4. /usr/bin(usr commads for applications)后期安装的一些软件
> 5. /usr/sbin(super user commands for applications)超级用户的一些管理程序

### 切换用户

| 命令        | 作用               |
| ----------- | ------------------ |
| su - 用户名 | 切换用户和工作目录 |
| exit        | 退出当前用户       |

### 修改文件权限

| 命令                         | 作用                   |
| ---------------------------- | ---------------------- |
| chown 用户名 文件名\|目录名  | 修改文件\|目录的拥有者 |
| chgrp -R 组名 文件名\|目录名 | 递归修改文件\|目录的组 |
| chmod -R 755 文件名\|目录名  | 递归修改文件\|目录权限 |

### 时间和日期

| 命令 | 作用                              |
| ---- | :-------------------------------- |
| cal  | 查看日历,-y选项可以查看一年的日历 |
| data | 查看系统时间                      |

### 磁盘信息

| 命令  | 作用                           |
| ----- | ------------------------------ |
| df -h | disk free显示磁盘剩余空间      |
| du -h | disk usage显示目录下的文件大小 |

> -h表示以人性化的方式显示文件大小 ls -h同理

### 进程信息

| 命令          | 作用                             |
| ------------- | -------------------------------- |
| ps aux        | process status查看进程的详细情况 |
| top           | 动态显示运行中的进程并且排序     |
| kill [-9] PID | 终止指定代号的进程               |

> ps默认只会显示当前用户通过终端启动的应用程序
> 
> ps选项说明功能
> 
> a:显示终端上的所有进程,包括其他用户的进程
> 
> u:显示进程的详细转台
> 
> x:显示没有控制终端的进程
> 
> 使用kill命令时,最好只终止由当前用户开启的进程,而不要终止root身份开启的进程,否则可能导致系统崩溃
> 
> 要退出top直接输入q

### 查找文件

| 命令                     | 作用                                       |
| ------------------------ | ------------------------------------------ |
| find [路径] -name "*.py" | 查找指定路径下扩展名是.py的文件,包括子目录 |

> 如果省略路径,表示在当前文件夹下查找
> 
> 之前学习的通配符,在使用find命令时同时使用

| 命令               | 作用                                   |
| ------------------ | -------------------------------------- |
| find -name "\*1*"  | 搜索当前目录下文件名包含1的文件        |
| find -name "*.txt" | 搜索当前目录下所有以.txt为扩展名的文件 |
| find -name "1*"    | 搜索当前目录下以数字1开头的文件        |

### 软链接

| 命令                          | 作用                                                     |
| ----------------------------- | -------------------------------------------------------- |
| ln -s 被链接的源文件 链接文件 | 建立文件的软链接,用通俗的方式讲类似于Windows下的快捷方式 |

> 没有-s选项建立的是一个硬连接文件(两个文件占用相同大小的硬盘空间,工作中几乎不会建立文件的硬连接)
> 
> 源文件要使用绝对路径,不能使用相对路径,这样可以方便移动链接文件后,仍然能够正常使用

![image-20221227094028383](.linux/image-20221227094028383.png)

### 打包和解压

| 命令                                  | 作用     |
| ------------------------------------- | -------- |
| tar -cvf 打包文件.tar 被压缩文件/路径 | 打包文件 |
| tar -xvf 打包文件.tar                 | 解包文件 |

tar选项说明:

| 选项 | 含义                                                    |
| ---- | ------------------------------------------------------- |
| c    | 生成档案文件,创建打包文件                               |
| x    | 解开档案文件                                            |
| v    | 列出归档解档的详细过程,显示进度                         |
| f    | 指定档案文件名称,f后面一定是.tar文件,所以必须放选项最后 |
| z    | 调用gzip,实现压缩和解压缩功能                           |
| j    | 调用bzip2,实现压缩和解压缩功能                          |
| C    | 解压缩到指定目录(要解压缩的目录必须存在)                |

| 命令                                      | 作用           |
| ----------------------------------------- | -------------- |
| tar -zcvf 打包文件.tar.gz 被压缩文件/路径 | 压缩           |
| tar -zxvf 打包文件.tar.gz                 | 解压           |
| tar -zxvf 打包文件.tar.gz -C 目标路径     | 解压至特定目录 |

> tar与gzip命令结合可以实现文件打包和压缩
> 
> - tar只负责打包文件,但不压缩
> - gzip压缩tar打包后的文件,其扩展名一般用xxx.tar.gz
> 
> 在linux中最常见的压缩文件格式就是xxx.tar.gz

| 命令                                       | 作用           |
| ------------------------------------------ | -------------- |
| tar -jcvf 打包文件.tar.bz2 被压缩文件/路径 | 压缩           |
| tar -jxvf 打包文件.tar.bz2                 | 解压           |
| tar -jxvf 打包文件.tar.bz2 -C 目标路径     | 解压至特定目录 |

> tar与bzip2(two)命令结合可以实现文件打包和压缩
> 
> - tar只负责打包文件,但不压缩
> - bzip2压缩tar打包后的文件,其扩展名一般用xxx.tar.bz2

### 端口

```bash
sudo lsof -i:端口号

sudo netstat -tunlp | grep 端口号
```

### 磁盘操作

**查看磁盘容量:**

```bash
#列出块设备的信息，包括设备名称、挂载点和容量等信息
sudo lsblk
#磁盘占用空间情况
sudo df -h
#查看整个磁盘的分区情况：
sudo fdisk -l
```

**扩容磁盘:**

1. 确认物理卷的大小，可以使用命令 `sudo pvdisplay` 查看。

2. 确认逻辑卷的名称，可以使用命令 `sudo lvdisplay` 查看。通常逻辑卷的名称为 `/dev/<vg-name>/<lv-name>`，其中 `<vg-name>` 是卷组名称，`<lv-name>` 是逻辑卷名称。

3. 在确认物理卷和逻辑卷名称后，可以使用以下命令将逻辑卷扩展到物理卷的大小：

```bash
#命令格式
sudo lvextend -l +100%FREE /dev/<vg-name>/<lv-name>
#我的 ubuntu
sudo lvextend -l +100%FREE /dev/ubuntu-vg/ubuntu-lv
```

    该命令中，`-l` 参数用于指定要扩展的逻辑卷大小，`+100%FREE` 表示将逻辑卷扩展到物理卷的大小。如果要扩展的大小不是物理卷的全部空间，可以使用其他格式来指定，例如 `+10G` 表示将逻辑卷扩展 10 GB 的大小。

4. 扩展逻辑卷后，需要将文件系统也扩展到逻辑卷的新空间。如果是 ext4 文件系统，可以使用以下命令进行扩展：

```bash
#命令格式
sudo resize2fs /dev/<vg-name>/<lv-name>
#我的 ubuntu
sudo resize2fs /dev/ubuntu-vg/ubuntu-lv
```

    该命令会将文件系统扩展到逻辑卷的新空间。

完成以上步骤后，逻辑卷就被扩展到了物理卷的大小。